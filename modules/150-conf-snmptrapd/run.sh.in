#!/bin/sh

echo "Configuration de snmptt"

if [ ! -f /etc/snmp/snmptrapd.conf.orig ]; then
    echo "Patch /etc/snmp/snmptrapd.conf"
    cfgpatch=snmptrapd.conf.$DISTRO.patch
    patch -N -b /etc/snmp/snmptrapd.conf < $cfgpatch
fi

file="/etc/sysconfig/snmptrapd"
if [ $DISTRO == "redhat" ]; then
    file="/etc/sysconfig/snmptrapd.options"
fi

if [ ! -f $file.orig ]; then
    echo "Patch /etc/sysconfig/snmptrad"
    cfgpatch=snmptrapd.init.$DISTRO.patch
    patch -N -b $file < $cfgpatch
fi

if [ ! -f /etc/snmp/snmptt.conf.orig ];then
    [ -f /etc/snmp/snmptt.conf ] || touch /etc/snmp/snmptt.conf
    mv /etc/snmp/snmptt.conf /etc/snmp/snmptt.conf.orig
    ln -s /etc/vigilo/vigiconf/prod/snmptt/snmptt.conf /etc/snmp/snmptt.conf
fi

TARGET="@LIBEXECDIR@/vigilo/snmptt"
if [ ! -d "$TARGET"  ];then
    mkdir $TARGET
    cp README $TARGET
fi
